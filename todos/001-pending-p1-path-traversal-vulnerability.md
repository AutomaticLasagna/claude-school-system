---
status: pending
priority: p1
issue_id: "001"
tags: [code-review, security]
---

# Path Traversal Vulnerability in Vite Middleware

## Problem Statement
The custom Vite middleware `serveDataDir()` constructed file paths using unsanitized user input from `req.url`. An attacker could use `../` sequences to read arbitrary files outside the `data/` directory. Combined with the server being bound to `0.0.0.0`, anyone on the local network could exploit this.

## Location
- `vite.config.js:13` (path construction)
- `vite.config.js:32` (0.0.0.0 binding)

## Status
**FIXED** - Path traversal protection added, server bound to localhost.

## Fix Applied
```js
const dataDir = path.resolve(process.cwd(), 'data')
const filePath = path.resolve(dataDir, req.url.replace(/^\//, ''))
if (!filePath.startsWith(dataDir + path.sep) && filePath !== dataDir) {
  res.statusCode = 403
  res.end('Forbidden')
  return
}
```
Also changed `host: '0.0.0.0'` to `host: 'localhost'`.

## Acceptance Criteria
- [ ] Navigate to `http://localhost:5174/data/../package.json` returns 403
- [ ] Dashboard still loads normally at `http://localhost:5174`
- [ ] Server not accessible from other machines on LAN
